import{_ as n,o as s,c as a,a as t}from"./app.4567a8ed.js";var e="/blog/images/posts/article-img/image-20230706095837998.png";const p={},o=t(`<h1 id="mongodb\u5B89\u88C5\u53CA\u57FA\u7840" tabindex="-1"><a class="header-anchor" href="#mongodb\u5B89\u88C5\u53CA\u57FA\u7840" aria-hidden="true">#</a> MongoDB\u5B89\u88C5\u53CA\u57FA\u7840</h1><h2 id="_1-mongodb\u7684\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#_1-mongodb\u7684\u5B89\u88C5" aria-hidden="true">#</a> 1. mongodb\u7684\u5B89\u88C5</h2><p>1). \u62C9\u53D6\u955C\u50CF</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull mongo:4.4
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>2). \u521B\u5EFA\u6570\u636E\u6302\u8F7D\u76EE\u5F55</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /home/mongodb/data
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /home/mongodb/log
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /home/mongodb/conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3). \u521B\u5EFA\u914D\u7F6E\u6587\u4EF6 <code>/home/mongodb/conf/mongo.conf</code>\u5982\u4E0B</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">net</span><span class="token punctuation">:</span>
	<span class="token comment"># \u7AEF\u53E3</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">27017</span>
  <span class="token comment"># \u8BBF\u95EEIP</span>
  <span class="token key atrule">bindIp</span><span class="token punctuation">:</span> 0.0.0.0
  <span class="token comment"># \u6700\u5927\u540C\u65F6\u8FDE\u63A5\u6570</span>
  <span class="token key atrule">maxIncomingConnections</span><span class="token punctuation">:</span> <span class="token number">100</span>
<span class="token key atrule">security</span><span class="token punctuation">:</span>
  <span class="token comment"># \u7528\u6237\u9A8C\u8BC1</span>
  <span class="token key atrule">authorization</span><span class="token punctuation">:</span> enabled
<span class="token key atrule">storage</span><span class="token punctuation">:</span>
  <span class="token comment"># \u6570\u636E\u6587\u4EF6</span>
  <span class="token key atrule">dbPath</span><span class="token punctuation">:</span> /data/db
  <span class="token key atrule">journal</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token comment"># \u5B58\u50A8\u5F15\u64CE\u6709mmapv1\u3001wiredTiger\u3001mongorocks</span>
  <span class="token key atrule">engine</span><span class="token punctuation">:</span> wiredTiger
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4). \u521B\u5EFA\u5BB9\u5668\u8FD0\u884C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">27017</span>:27017 <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> /home/mongodb/data:/data/db <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> /home/mongodb/conf:/data/configdb <span class="token punctuation">\\</span>
<span class="token parameter variable">--name</span> mongo mongo:4.4 <span class="token punctuation">\\</span>
<span class="token parameter variable">--config</span> /data/configdb/mongo.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4). \u8FDB\u5165\u5BB9\u5668\uFF0C\u521B\u5EFA\u8D26\u53F7</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> \u5BB9\u5668id <span class="token function">bash</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>5). \u4F7F\u7528mongo\u547D\u4EE4\u884C\u6DFB\u52A0\u8D26\u53F7</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>mongo
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-mongo ext-mongo line-numbers-mode"><pre class="language-mongo"><code>use admin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-mongo ext-mongo line-numbers-mode"><pre class="language-mongo"><code># \u521B\u5EFA\u7528\u6237 root\uFF0C\u5BC6\u7801\u4E3A root \u89D2\u8272\u4E3A root
db.createUser({user:&quot;root&quot;,pwd:&quot;root&quot;,roles:[&quot;root&quot;]})
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>6). \u767B\u9646\u9A8C\u8BC1</p><div class="language-mongo ext-mongo line-numbers-mode"><pre class="language-mongo"><code>db.auth(&quot;root&quot;,&quot;root&quot;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_2-\u76F8\u5173\u6982\u5FF5" tabindex="-1"><a class="header-anchor" href="#_2-\u76F8\u5173\u6982\u5FF5" aria-hidden="true">#</a> 2. \u76F8\u5173\u6982\u5FF5</h2><h3 id="_2-1-\u57FA\u7840" tabindex="-1"><a class="header-anchor" href="#_2-1-\u57FA\u7840" aria-hidden="true">#</a> 2.1 \u57FA\u7840</h3><table><thead><tr><th style="text-align:center;">SQL</th><th style="text-align:center;">Mongo</th><th style="text-align:center;">SQL/Mongo\u8BF4\u660E</th></tr></thead><tbody><tr><td style="text-align:center;">database</td><td style="text-align:center;">database</td><td style="text-align:center;">\u6570\u636E\u5E93</td></tr><tr><td style="text-align:center;">table</td><td style="text-align:center;">collection</td><td style="text-align:center;">\u6570\u636E\u5E93\u8868/\u96C6\u5408</td></tr><tr><td style="text-align:center;">row</td><td style="text-align:center;">document</td><td style="text-align:center;">\u6570\u636E\u8BB0\u5F55\u884C/\u6587\u6863</td></tr><tr><td style="text-align:center;">column</td><td style="text-align:center;">field</td><td style="text-align:center;">\u6570\u636E\u5B57\u6BB5/\u57DF</td></tr><tr><td style="text-align:center;">index</td><td style="text-align:center;">index</td><td style="text-align:center;">\u7D22\u5F15</td></tr><tr><td style="text-align:center;">primary key</td><td style="text-align:center;">primary key</td><td style="text-align:center;">\u4E3B\u952E\uFF0Cmongo\u4E2D\u81EA\u52A8\u5C06_id\u4F5C\u4E3A\u4E3B\u952E</td></tr></tbody></table><h2 id="_3-\u57FA\u672C\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_3-\u57FA\u672C\u64CD\u4F5C" aria-hidden="true">#</a> 3. \u57FA\u672C\u64CD\u4F5C</h2><h3 id="_3-1-\u6570\u636E\u5E93\u76F8\u5173\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_3-1-\u6570\u636E\u5E93\u76F8\u5173\u64CD\u4F5C" aria-hidden="true">#</a> 3.1 \u6570\u636E\u5E93\u76F8\u5173\u64CD\u4F5C</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u67E5\u770B\u6240\u6709\u7684\u6570\u636E\u5E93</span>
<span class="token operator">&gt;</span> show dbs
admin   <span class="token number">0</span>.000GB
config  <span class="token number">0</span>.000GB
<span class="token builtin class-name">local</span>   <span class="token number">0</span>.000GB

<span class="token comment"># \u901A\u8FC7use\u5173\u952E\u5B57\u5207\u6362\u6570\u636E\u5E93</span>
<span class="token operator">&gt;</span> use admin
switched to db admin


<span class="token comment"># \u521B\u5EFA\u6570\u636E\u5E93</span>
<span class="token comment"># \u8BF4\u660E\uFF1A\u5728MongoDB\u4E2D\uFF0C\u6570\u636E\u5E93\u662F\u81EA\u52A8\u521B\u5EFA\u7684\uFF0C\u901A\u8FC7use\u5207\u6362\u5230\u65B0\u6570\u636E\u5E93\u4E2D\uFF0C\u8FDB\u884C\u63D2\u5165\u6570\u636E\u5373\u53EF\u81EA\u52A8\u521B\u5EFA\u6570\u636E\u5E93</span>
<span class="token operator">&gt;</span> use testdb
switched to db testdb


<span class="token comment">#\u5E76\u6CA1\u6709\u521B\u5EFA\u6570\u636E\u5E93</span>
<span class="token operator">&gt;</span> show dbs 
admin <span class="token number">0</span>.000GB
config <span class="token number">0</span>.000GB
<span class="token builtin class-name">local</span> <span class="token number">0</span>.000GB

<span class="token comment"># \u63D2\u5165\u6570\u636E</span>
<span class="token operator">&gt;</span> db.user.insert<span class="token punctuation">(</span><span class="token punctuation">{</span>id:1,name:<span class="token string">&#39;zhangsan&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">&quot;nInserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># \u6570\u636E\u5E93\u81EA\u52A8\u521B\u5EFA</span>
<span class="token operator">&gt;</span> show dbs
admin <span class="token number">0</span>.000GB
config <span class="token number">0</span>.000GB
<span class="token builtin class-name">local</span> <span class="token number">0</span>.000GB
testdb <span class="token number">0</span>.000GB

<span class="token comment"># \u67E5\u770B\u96C6\u5408</span>
<span class="token operator">&gt;</span> show collections
user


<span class="token comment"># \u5220\u9664\u96C6\u5408</span>
<span class="token operator">&gt;</span> db.user.drop<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token boolean">true</span> <span class="token comment">#\u5982\u679C\u6210\u529F\u5220\u9664\u9009\u5B9A\u96C6\u5408\uFF0C\u5219 drop() \u65B9\u6CD5\u8FD4\u56DE true\uFF0C\u5426\u5219\u8FD4\u56DE false\u3002</span>


<span class="token comment"># \u5220\u9664\u6570\u636E\u5E93</span>
<span class="token operator">&gt;</span> use testdb <span class="token comment">#\u5148\u5207\u6362\u5230\u8981\u5220\u9664\u7684\u6570\u636E\u4E2D</span>
switched to db testdb
<span class="token comment"># \u5220\u9664\u6570\u636E\u5E93</span>
<span class="token operator">&gt;</span> db.<span class="token function-name function">dropDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span> <span class="token string">&quot;dropped&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;testdb&quot;</span>, <span class="token string">&quot;ok&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> show dbs
admin <span class="token number">0</span>.000GB
config <span class="token number">0</span>.000GB
<span class="token builtin class-name">local</span> <span class="token number">0</span>.000GB

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-\u6570\u636E\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_3-2-\u6570\u636E\u64CD\u4F5C" aria-hidden="true">#</a> 3.2 \u6570\u636E\u64CD\u4F5C</h3><h4 id="\u589E" tabindex="-1"><a class="header-anchor" href="#\u589E" aria-hidden="true">#</a> \u589E</h4><blockquote><p><strong>\u8BED\u6CD5\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>db.COLLECTION_NAME.insert<span class="token punctuation">(</span>document<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5728MongoDB\u4E2D\uFF0C\u5B58\u50A8\u7684\u6587\u6863\u7ED3\u6784\u662F\u4E00\u79CD\u7C7B\u4F3C\u4E8Ejson\u7684\u7ED3\u6784\uFF0C\u79F0\u4E4B\u4E3Abson\uFF08\u5168\u79F0\u4E3A\uFF1ABinary JSON\uFF09\u3002</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u63D2\u5165\u6570\u636E</span>
<span class="token operator">&gt;</span> db.user.insert<span class="token punctuation">(</span><span class="token punctuation">{</span>id:1,username:<span class="token string">&#39;zhangsan&#39;</span>,age:20<span class="token punctuation">}</span><span class="token punctuation">)</span>
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">&quot;nInserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db.user.save<span class="token punctuation">(</span><span class="token punctuation">{</span>id:2,username:<span class="token string">&#39;lisi&#39;</span>,age:25<span class="token punctuation">}</span><span class="token punctuation">)</span>
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">&quot;nInserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment"># \u67E5\u8BE2\u6570\u636E</span>
<span class="token operator">&gt;</span> db.user.<span class="token function-name function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0024b318926e0c1f6dc&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>, <span class="token string">&quot;username&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;zhangsan&quot;</span>,
<span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">20</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0134b318926e0c1f6dd&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>, <span class="token string">&quot;username&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;lisi&quot;</span>,
<span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">25</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5220" tabindex="-1"><a class="header-anchor" href="#\u5220" aria-hidden="true">#</a> \u5220</h4><blockquote><p><strong>\u8BED\u6CD5\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>db.collection.remove<span class="token punctuation">(</span>
<span class="token operator">&lt;</span>query<span class="token operator">&gt;</span>,
	<span class="token punctuation">{</span>
    justOne: <span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span>,
    writeConcern: <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u53C2\u6570\u8BF4\u660E\uFF1A</strong></p><ul><li><strong>query</strong> :\uFF08\u53EF\u9009\uFF09\u5220\u9664\u7684\u6587\u6863\u7684\u6761\u4EF6\u3002</li><li><strong>justOne</strong> : \uFF08\u53EF\u9009\uFF09\u5982\u679C\u8BBE\u4E3A true \u6216 1\uFF0C\u5219\u53EA\u5220\u9664\u4E00\u4E2A\u6587\u6863\uFF0C\u5982\u679C\u4E0D\u8BBE\u7F6E\u8BE5\u53C2\u6570\uFF0C\u6216\u4F7F\u7528\u9ED8\u8BA4\u503C false\uFF0C\u5219\u5220\u9664\u6240\u6709\u5339\u914D\u6761\u4EF6\u7684\u6587\u6863\u3002</li><li><strong>writeConcern</strong> :\uFF08\u53EF\u9009\uFF09\u629B\u51FA\u5F02\u5E38\u7684\u7EA7\u522B\u3002</li></ul></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token operator">&gt;</span> db.user.remove<span class="token punctuation">(</span><span class="token punctuation">{</span>age:25<span class="token punctuation">}</span><span class="token punctuation">)</span>
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">&quot;nRemoved&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">#\u5220\u9664\u4E862\u6761\u6570\u636E</span>
<span class="token comment">#\u63D2\u51654\u6761\u6D4B\u8BD5\u6570\u636E</span>
db.user.insert<span class="token punctuation">(</span><span class="token punctuation">{</span>id:1,username:<span class="token string">&#39;zhangsan&#39;</span>,age:20<span class="token punctuation">}</span><span class="token punctuation">)</span>
db.user.insert<span class="token punctuation">(</span><span class="token punctuation">{</span>id:2,username:<span class="token string">&#39;lisi&#39;</span>,age:21<span class="token punctuation">}</span><span class="token punctuation">)</span>
db.user.insert<span class="token punctuation">(</span><span class="token punctuation">{</span>id:3,username:<span class="token string">&#39;wangwu&#39;</span>,age:22<span class="token punctuation">}</span><span class="token punctuation">)</span>
db.user.insert<span class="token punctuation">(</span><span class="token punctuation">{</span>id:4,username:<span class="token string">&#39;zhaoliu&#39;</span>,age:22<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">&gt;</span> db.user.remove<span class="token punctuation">(</span><span class="token punctuation">{</span>age:22<span class="token punctuation">}</span>,true<span class="token punctuation">)</span>
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">&quot;nRemoved&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">#\u5220\u9664\u4E861\u6761\u6570\u636E</span>
<span class="token comment">#\u5220\u9664\u6240\u6709\u6570\u636E</span>
<span class="token operator">&gt;</span> db.user.remove<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">#\u8BF4\u660E\uFF1A\u4E3A\u4E86\u7B80\u5316\u64CD\u4F5C\uFF0C\u5B98\u65B9\u63A8\u8350\u4F7F\u7528deleteOne()\u4E0EdeleteMany()\u8FDB\u884C\u5220\u9664\u6570\u636E\u64CD\u4F5C\u3002</span>
db.user.deleteOne<span class="token punctuation">(</span><span class="token punctuation">{</span>id:1<span class="token punctuation">}</span><span class="token punctuation">)</span>
db.user.deleteMany<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">#\u5220\u9664\u6240\u6709\u6570\u636E</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6539" tabindex="-1"><a class="header-anchor" href="#\u6539" aria-hidden="true">#</a> \u6539</h4><blockquote><p><strong>\u8BED\u6CD5\uFF1A</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>db.collection.update(
  &lt;query&gt;,
  &lt;update&gt;,
  [
    upsert: &lt;boolean&gt;,
    multi: &lt;boolean&gt;,
    writeConcern: &lt;document&gt;
  ]
)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u53C2\u6570\u8BF4\u660E\uFF1A</strong></p><ul><li><strong>query</strong> : update\u7684\u67E5\u8BE2\u6761\u4EF6\uFF0C\u7C7B\u4F3Csql update\u67E5\u8BE2\u5185where\u540E\u9762\u7684\u3002</li><li><strong>update</strong> : update\u7684\u5BF9\u8C61\u548C\u4E00\u4E9B\u66F4\u65B0\u7684\u64CD\u4F5C\u7B26\uFF08\u5982inc...\uFF09\u7B49\uFF0C\u4E5F\u53EF\u4EE5\u7406\u89E3\u4E3Asql update\u67E5\u8BE2\u5185set\u540E\u9762\u7684</li><li><strong>upsert</strong> : \u53EF\u9009\uFF0C\u8FD9\u4E2A\u53C2\u6570\u7684\u610F\u601D\u662F\uFF0C\u5982\u679C\u4E0D\u5B58\u5728update\u7684\u8BB0\u5F55\uFF0C\u662F\u5426\u63D2\u5165objNew,true\u4E3A\u63D2\u5165\uFF0C\u9ED8\u8BA4\u662Ffalse\uFF0C\u4E0D\u63D2\u5165\u3002</li><li><strong>multi</strong> : \u53EF\u9009\uFF0Cmongodb \u9ED8\u8BA4\u662Ffalse,\u53EA\u66F4\u65B0\u627E\u5230\u7684\u7B2C\u4E00\u6761\u8BB0\u5F55\uFF0C\u5982\u679C\u8FD9\u4E2A\u53C2\u6570\u4E3Atrue,\u5C31\u628A\u6309\u6761\u4EF6\u67E5\u51FA\u6765\u591A\u6761\u8BB0\u5F55\u5168\u90E8\u66F4\u65B0\u3002</li><li><strong>writeConcern</strong> :\u53EF\u9009\uFF0C\u629B\u51FA\u5F02\u5E38\u7684\u7EA7\u522B\u3002</li></ul></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u67E5\u770B\u66F4\u65B0\u540E</span>
<span class="token operator">&gt;</span> db.user.<span class="token function-name function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0024b318926e0c1f6dc&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>, <span class="token string">&quot;username&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;zhangsan&quot;</span>,
<span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">20</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0134b318926e0c1f6dd&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>, <span class="token string">&quot;username&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;lisi&quot;</span>,
<span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">25</span> <span class="token punctuation">}</span>

<span class="token comment"># \u66F4\u65B0\u6570\u636E</span>
<span class="token operator">&gt;</span> db.user.update<span class="token punctuation">(</span><span class="token punctuation">{</span>id:1<span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token variable">$set</span>:<span class="token punctuation">{</span>age:22<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">&quot;nMatched&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>, <span class="token string">&quot;nUpserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>, <span class="token string">&quot;nModified&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># \u67E5\u770B\u66F4\u65B0\u524D</span>
<span class="token operator">&gt;</span> db.user.<span class="token function-name function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0024b318926e0c1f6dc&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>, <span class="token string">&quot;username&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;zhangsan&quot;</span>,
<span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">22</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0134b318926e0c1f6dd&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>, <span class="token string">&quot;username&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;lisi&quot;</span>,
<span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">25</span> <span class="token punctuation">}</span>

<span class="token comment"># \u6CE8\u610F\uFF1A\u5982\u679C\u8FD9\u6837\u5199\uFF0C\u4F1A\u5220\u9664\u6389\u5176\u4ED6\u7684\u5B57\u6BB5</span>
<span class="token operator">&gt;</span> db.user.update<span class="token punctuation">(</span><span class="token punctuation">{</span>id:1<span class="token punctuation">}</span>,<span class="token punctuation">{</span>age:25<span class="token punctuation">}</span><span class="token punctuation">)</span>
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">&quot;nMatched&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>, <span class="token string">&quot;nUpserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>, <span class="token string">&quot;nModified&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db.user.<span class="token function-name function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0024b318926e0c1f6dc&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">25</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0134b318926e0c1f6dd&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>, <span class="token string">&quot;username&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;lisi&quot;</span>,
<span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">25</span> <span class="token punctuation">}</span>
<span class="token comment"># \u66F4\u65B0\u4E0D\u5B58\u5728\u7684\u5B57\u6BB5\uFF0C\u4F1A\u65B0\u589E\u5B57\u6BB5</span>
<span class="token operator">&gt;</span> db.user.update<span class="token punctuation">(</span><span class="token punctuation">{</span>id:2<span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token variable">$set</span>:<span class="token punctuation">{</span>sex:1<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">#\u66F4\u65B0\u6570\u636E</span>
<span class="token comment"># \u67E5\u770B\u66F4\u65B0\u540E</span>
<span class="token operator">&gt;</span> db.user.<span class="token function-name function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0024b318926e0c1f6dc&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">25</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0134b318926e0c1f6dd&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>, <span class="token string">&quot;username&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;lisi&quot;</span>,
<span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">25</span>, <span class="token string">&quot;sex&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>

<span class="token comment">#\u66F4\u65B0\u4E0D\u5B58\u5728\u7684\u6570\u636E\uFF0C\u9ED8\u8BA4\u4E0D\u4F1A\u65B0\u589E\u6570\u636E</span>
<span class="token operator">&gt;</span> db.user.update<span class="token punctuation">(</span><span class="token punctuation">{</span>id:3<span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token variable">$set</span>:<span class="token punctuation">{</span>sex:1<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">&quot;nMatched&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>, <span class="token string">&quot;nUpserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>, <span class="token string">&quot;nModified&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db.user.<span class="token function-name function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0024b318926e0c1f6dc&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">25</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0134b318926e0c1f6dd&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>, <span class="token string">&quot;username&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;lisi&quot;</span>,
<span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">25</span>, <span class="token string">&quot;sex&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>

<span class="token comment"># \u5982\u679C\u8BBE\u7F6E\u7B2C\u4E00\u4E2A\u53C2\u6570\u4E3Atrue\uFF0C\u5C31\u662F\u65B0\u589E\u6570\u636E</span>
<span class="token operator">&gt;</span> db.user.update<span class="token punctuation">(</span><span class="token punctuation">{</span>id:3<span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token variable">$set</span>:<span class="token punctuation">{</span>sex:1<span class="token punctuation">}</span><span class="token punctuation">}</span>,true<span class="token punctuation">)</span>
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token string">&quot;nMatched&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
<span class="token string">&quot;nUpserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
<span class="token string">&quot;nModified&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
<span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08cb281418d073246bc642&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># \u67E5\u770B\u66F4\u65B0\u540E</span>
<span class="token operator">&gt;</span> db.user.<span class="token function-name function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0024b318926e0c1f6dc&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">25</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08c0134b318926e0c1f6dd&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>, <span class="token string">&quot;username&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;lisi&quot;</span>,
<span class="token string">&quot;age&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">25</span>, <span class="token string">&quot;sex&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;5c08cb281418d073246bc642&quot;</span><span class="token punctuation">)</span>, <span class="token string">&quot;id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">3</span>, <span class="token string">&quot;sex&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u67E5" tabindex="-1"><a class="header-anchor" href="#\u67E5" aria-hidden="true">#</a> \u67E5</h4><blockquote><p><strong>\u8BED\u6CD5</strong>\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>db.collection.find<span class="token punctuation">(</span><span class="token punctuation">[</span>query<span class="token punctuation">]</span>,<span class="token punctuation">[</span>fields<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u53C2\u6570\u8BF4\u540D\uFF1A</strong></p><ul><li>query \uFF1A\u53EF\u9009\uFF0C\u4F7F\u7528\u67E5\u8BE2\u64CD\u4F5C\u7B26\u6307\u5B9A\u67E5\u8BE2\u6761\u4EF6</li><li>fields \uFF1A\u53EF\u9009\uFF0C\u4F7F\u7528\u6295\u5F71\u64CD\u4F5C\u7B26\u6307\u5B9A\u8FD4\u56DE\u7684\u952E\u3002\u67E5\u8BE2\u65F6\u8FD4\u56DE\u6587\u6863\u4E2D\u6240\u6709\u952E\u503C\uFF0C \u53EA\u9700\u7701\u7565\u8BE5\u53C2\u6570\u5373\u53EF\uFF08\u9ED8\u8BA4\u7701\u7565\uFF09\u3002</li></ul></blockquote><p><em><code>db.col.find().pretty()</code>\u683C\u5F0F\u5316\u67E5\u8BE2</em></p><p><img src="`+e+`" alt="image-20230706095837998"></p><blockquote><p><strong>\u6761\u4EF6\u67E5\u8BE2</strong></p></blockquote><table><thead><tr><th style="text-align:center;">\u64CD\u4F5C</th><th style="text-align:center;">\u683C\u5F0F</th><th style="text-align:center;">\u793A\u4F8B</th><th style="text-align:center;">\u5BF9\u5E94SQL</th></tr></thead><tbody><tr><td style="text-align:center;">\u7B49\u4E8E\uFF08 = \uFF09</td><td style="text-align:center;"><code>{&lt;key&gt;:&lt;value&gt; }</code></td><td style="text-align:center;"><code>db.user.find({&quot;name&quot;:&quot;qzk&quot;})</code></td><td style="text-align:center;"><code>where name = &#39;qzk&#39;</code></td></tr><tr><td style="text-align:center;">\u5C0F\u4E8E\uFF08 &lt; \uFF09</td><td style="text-align:center;"><code>{&lt;key&gt;:{$lt:&lt;value&gt;}}</code></td><td style="text-align:center;"><code>db.user.find({&quot;age&quot;:{$lt:20}})</code></td><td style="text-align:center;"><code>where age &lt; 20</code></td></tr><tr><td style="text-align:center;">\u5C0F\u4E8E\u6216\u7B49\u4E8E ( &lt;= )</td><td style="text-align:center;"><code>{&lt;key&gt;:{$lte:&lt;value&gt;}}</code></td><td style="text-align:center;"><code>db.user.find({&quot;age&quot;:{$lte:20}})</code></td><td style="text-align:center;"><code>where age &lt;= 20</code></td></tr><tr><td style="text-align:center;">\u5927\u4E8E ( &gt; )</td><td style="text-align:center;"><code>{&lt;key&gt;:{$gt:&lt;value&gt;}}</code></td><td style="text-align:center;"><code>db.user.find({&quot;age&quot;:{$gt:20}})</code></td><td style="text-align:center;"><code>where age &gt; 20</code></td></tr><tr><td style="text-align:center;">\u5927\u4E8E\u6216\u7B49\u4E8E ( &gt;= )</td><td style="text-align:center;"><code>{&lt;key&gt;:{$gte:&lt;value&gt;}}</code></td><td style="text-align:center;"><code>db.user.find({&quot;age&quot;:{$gte:20}})</code></td><td style="text-align:center;"><code>where age &gt;= 20</code></td></tr><tr><td style="text-align:center;">\u4E0D\u7B49\u4E8E ( != )</td><td style="text-align:center;"><code>{&lt;key&gt;:{$ne:&lt;value&gt;}}</code></td><td style="text-align:center;"><code>db.user.find({&quot;age&quot;:{$ne:20}})</code></td><td style="text-align:center;"><code>where age != 20</code></td></tr></tbody></table><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u63D2\u5165\u6D4B\u8BD5\u6570\u636E</span>
db.user.insert<span class="token punctuation">(</span><span class="token punctuation">{</span>id:1,username:<span class="token string">&#39;zhangsan&#39;</span>,age:20<span class="token punctuation">}</span><span class="token punctuation">)</span>
db.user.insert<span class="token punctuation">(</span><span class="token punctuation">{</span>id:2,username:<span class="token string">&#39;lisi&#39;</span>,age:21<span class="token punctuation">}</span><span class="token punctuation">)</span>
db.user.insert<span class="token punctuation">(</span><span class="token punctuation">{</span>id:3,username:<span class="token string">&#39;wangwu&#39;</span>,age:22<span class="token punctuation">}</span><span class="token punctuation">)</span>
db.user.insert<span class="token punctuation">(</span><span class="token punctuation">{</span>id:4,username:<span class="token string">&#39;zhaoliu&#39;</span>,age:22<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment"># \u53EA\u67E5\u8BE2id\u4E0Eusername\u5B57\u6BB5</span>
db.user.find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span>id:1,username:1<span class="token punctuation">}</span><span class="token punctuation">)</span> 


<span class="token comment"># \u67E5\u8BE2\u6570\u636E\u6761\u6570</span>
db.user.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.count<span class="token punctuation">(</span><span class="token punctuation">)</span> 


<span class="token comment"># \u67E5\u8BE2id\u4E3A1\u7684\u6570\u636E</span>
db.user.find<span class="token punctuation">(</span><span class="token punctuation">{</span>id:1<span class="token punctuation">}</span><span class="token punctuation">)</span> 


<span class="token comment"># \u67E5\u8BE2\u5C0F\u4E8E\u7B49\u4E8E21\u7684\u6570\u636E</span>
db.user.find<span class="token punctuation">(</span><span class="token punctuation">{</span>age:<span class="token punctuation">{</span><span class="token variable">$lte</span>:21<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment"># and\u67E5\u8BE2\uFF0Cage\u5C0F\u4E8E\u7B49\u4E8E21\u5E76\u4E14id\u5927\u4E8E\u7B49\u4E8E2</span>
db.user.find<span class="token punctuation">(</span><span class="token punctuation">{</span>age:<span class="token punctuation">{</span><span class="token variable">$lte</span>:21<span class="token punctuation">}</span>, id:<span class="token punctuation">{</span><span class="token variable">$gte</span>:2<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 


<span class="token comment"># \u67E5\u8BE2id=1 or id=2</span>
db.user.find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token variable">$or</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span>id:1<span class="token punctuation">}</span>,<span class="token punctuation">{</span>id:2<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment"># \u5206\u9875\u67E5\u8BE2\uFF1ASkip()\u8DF3\u8FC7\u51E0\u6761\uFF0Climit()\u67E5\u8BE2\u6761\u6570</span>
db.user.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.limit<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>.skip<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#\u8DF3\u8FC71\u6761\u6570\u636E\uFF0C\u67E5\u8BE22\u6761\u6570\u636E</span>


<span class="token comment"># \u6309\u7167age\u5012\u5E8F\u6392\u5E8F\uFF0C-1\u4E3A\u5012\u5E8F\uFF0C1\u4E3A\u6B63\u5E8F</span>
db.user.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.sort<span class="token punctuation">(</span><span class="token punctuation">{</span>id:-1<span class="token punctuation">}</span><span class="token punctuation">)</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-\u7D22\u5F15\u548C\u7D22\u5F15\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_4-\u7D22\u5F15\u548C\u7D22\u5F15\u64CD\u4F5C" aria-hidden="true">#</a> 4. \u7D22\u5F15\u548C\u7D22\u5F15\u64CD\u4F5C</h2><h3 id="_4-1-\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#_4-1-\u7D22\u5F15" aria-hidden="true">#</a> 4.1 \u7D22\u5F15</h3><p>\u7D22\u5F15\u901A\u5E38\u80FD\u591F\u6781\u5927\u7684\u63D0\u9AD8\u67E5\u8BE2\u7684\u6548\u7387\uFF0C\u5982\u679C\u6CA1\u6709\u7D22\u5F15\uFF0CMongoDB\u5728\u8BFB\u53D6\u6570\u636E\u65F6\u5FC5\u987B\u626B\u63CF\u96C6\u5408\u4E2D\u7684\u6BCF\u4E2A\u6587\u4EF6\u5E76\u9009\u53D6\u90A3\u4E9B\u7B26\u5408\u67E5\u8BE2\u6761\u4EF6\u7684\u8BB0\u5F55\u3002</p><p>\u7D22\u5F15\u662F\u7279\u6B8A\u7684\u6570\u636E\u7ED3\u6784\uFF0C\u7D22\u5F15\u5B58\u50A8\u5728\u4E00\u4E2A\u6613\u4E8E\u904D\u5386\u8BFB\u53D6\u7684\u6570\u636E\u96C6\u5408\u4E2D\uFF0C\u7D22\u5F15\u662F\u5BF9\u6570\u636E\u5E93\u8868\u4E2D\u4E00\u5217\u6216\u591A\u5217\u7684\u503C\u8FDB\u884C\u6392\u5E8F\u7684\u4E00\u79CD\u7ED3\u6784\u3002</p><h3 id="_4-2-\u7D22\u5F15\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_4-2-\u7D22\u5F15\u64CD\u4F5C" aria-hidden="true">#</a> 4.2 \u7D22\u5F15\u64CD\u4F5C</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u67E5\u770B\u7D22\u5F15\u793A\u4F8B</span>
<span class="token operator">&gt;</span> db.user.getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span> <span class="token punctuation">{</span> <span class="token string">&quot;v&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>, <span class="token string">&quot;key&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>, <span class="token string">&quot;name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;_id_&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token comment"># v:\u7248\u672C\u53F7  key\uFF1A\u7D22\u5F15\u5B57\u6BB5 1 \u8868\u793A\u5347\u5E8F   name\uFF1A\u7D22\u5F15\u540D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u793A\u4F8B</span>
<span class="token operator">&gt;</span> db.user.createIndex<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;age&#39;</span>:1<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;createdCollectionAutomatically&quot;</span> <span class="token builtin class-name">:</span> false,
  <span class="token string">&quot;numIndexesBefore&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
  <span class="token string">&quot;numIndexesAfter&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>,
  <span class="token string">&quot;ok&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5220\u9664\u7D22\u5F15\u793A\u4F8B</span>
db.user.dropIndex<span class="token punctuation">(</span><span class="token string">&quot;age_1&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># \u5220\u9664\u9664\u4E86_id\u4E4B\u5916\u7684\u7D22\u5F15</span>
db.user.dropIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u521B\u5EFA\u8054\u5408\u7D22\u5F15</span>
db.user.createIndex<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;age&#39;</span>:1, <span class="token string">&#39;id&#39;</span>:-1<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u67E5\u770B\u7D22\u5F15\u5927\u5C0F\uFF0C\u5355\u4F4D\uFF1A\u5B57\u8282</span>
db.user.totalIndexSize<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-\u6574\u5408spring" tabindex="-1"><a class="header-anchor" href="#_5-\u6574\u5408spring" aria-hidden="true">#</a> 5. \u6574\u5408spring</h2><h3 id="_5-1-\u73AF\u5883\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#_5-1-\u73AF\u5883\u51C6\u5907" aria-hidden="true">#</a> 5.1 \u73AF\u5883\u51C6\u5907</h3><p><strong>\u5F15\u5165\u4F9D\u8D56</strong></p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code> <span class="token comment">&lt;!-- mongodb-starter --&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-mongodb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 <span class="token comment">&lt;!-- spring-test --&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>mongodb\u914D\u7F6E</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">data</span><span class="token punctuation">:</span>
    <span class="token key atrule">mongodb</span><span class="token punctuation">:</span>
      <span class="token key atrule">username</span><span class="token punctuation">:</span> root
      <span class="token key atrule">password</span><span class="token punctuation">:</span> root
      <span class="token key atrule">authentication-database</span><span class="token punctuation">:</span> admin
      <span class="token key atrule">host</span><span class="token punctuation">:</span> 43.142.63.121
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">27017</span>
      <span class="token key atrule">database</span><span class="token punctuation">:</span> testdb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6587\u6863\u5B9E\u4F53\u7C7B</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Builder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bson<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span><span class="token class-name">ObjectId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Id</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>index<span class="token punctuation">.</span></span><span class="token class-name">Indexed</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span></span><span class="token class-name">Document</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span></span><span class="token class-name">Field</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDateTime</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>collection <span class="token operator">=</span> <span class="token string">&quot;person&quot;</span><span class="token punctuation">)</span> <span class="token comment">// \u6307\u5B9Acollation\u540D\u79F0</span>
<span class="token annotation punctuation">@Builder</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
		<span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Indexed</span>  <span class="token comment">// \u8868\u793A\u5B57\u6BB5\u9700\u8981\u521B\u5EFA\u7D22\u5F15</span>
  	<span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
   	<span class="token annotation punctuation">@Indexed</span>  <span class="token comment">// \u8868\u793A\u5B57\u6BB5\u9700\u8981\u521B\u5EFA\u7D22\u5F15</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-2-mongotemplate\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#_5-2-mongotemplate\u4F7F\u7528" aria-hidden="true">#</a> 5.2 MongoTemplate\u4F7F\u7528</h3><h4 id="\u589E-1" tabindex="-1"><a class="header-anchor" href="#\u589E-1" aria-hidden="true">#</a> \u589E</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u63D2\u5165\u6587\u6863\u793A\u4F8B
 */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">savePerson</span><span class="token punctuation">(</span><span class="token class-name">Person</span> person<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u9ED8\u8BA4\u4E0D\u4F20\u9012 collectionName \u5C06\u4F1A\u4F7F\u7528\u53C2\u6570\u7684\u7C7B\u540D\u9996\u5B57\u6BCD\u5C0F\u5199\u4F5C\u4E3Acollection\u7684\u540D\u5B57</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * \u6279\u91CF\u63D2\u5165\u793A\u4F8B
 */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveBatchPerson</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">insertAll</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5220-1" tabindex="-1"><a class="header-anchor" href="#\u5220-1" aria-hidden="true">#</a> \u5220</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u6309id\u5220\u9664
 */</span>
<span class="token keyword">public</span> <span class="token class-name">DeleteResult</span> <span class="token function">deleteById</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6539-1" tabindex="-1"><a class="header-anchor" href="#\u6539-1" aria-hidden="true">#</a> \u6539</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u4FEE\u6539\u5E74\u9F84\u793A\u4F8B
 */</span>
<span class="token keyword">public</span> <span class="token class-name">UpdateResult</span> <span class="token function">updateAge</span><span class="token punctuation">(</span><span class="token class-name">Person</span> person<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Update</span> update <span class="token operator">=</span> <span class="token class-name">Update</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> person<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">updateFirst</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> update<span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u67E5-1" tabindex="-1"><a class="header-anchor" href="#\u67E5-1" aria-hidden="true">#</a> \u67E5</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u6309\u540D\u5B57\u67E5\u8BE2Person\u793A\u4F8B
 */</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryPersonListByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * \u5206\u9875\u67E5\u8BE2\u793A\u4F8B
 */</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryPersonListPage</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> page<span class="token punctuation">,</span> <span class="token class-name">Integer</span> rows<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> rows<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,68),c=[o];function l(i,u){return s(),a("div",null,c)}var r=n(p,[["render",l],["__file","mongodb\u57FA\u7840\u4F7F\u7528.html.vue"]]);export{r as default};
